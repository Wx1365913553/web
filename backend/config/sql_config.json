[
  {
    "name": "1",
    "filename_prefix": "血清直接胆红素测定、总胆红素测定检查费用时，同时收取通过计算得出的血清间接胆红素测定费用",
    "codes": [
      ""
    ],
    "sql_template": " select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME  受单科室名称 ,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称,case when item_name='血清间接胆红素测定' then '1' else '0' end 违规标记  from  门诊明细 a left join 门诊主单 b on a.hisid=b.hisid  where  item_name in ('血清直接胆红素测定','血清总胆红素测定','血清间接胆红素测定') and a.hisid in(select hisid from 门诊明细 where (item_name='血清直接胆红素测定' or item_name ='血清总胆红素测定') and hisid in(select hisid from 门诊明细 where item_name='血清间接胆红素测定'))   and b.BILL_DATE>'2023-10-01' union all select '住院' 类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称,case when item_name ='血清间接胆红素测定'  then '1' else '0' end 违规标记  from 住院明细 a left join 住院主单 b on a.zyh=b.zyh  where item_name in ('血清直接胆红素测定','血清总胆红素测定','血清间接胆红素测定')  and a.hisid in(select hisid from 住院明细 where (item_name='血清直接胆红素测定' or item_name ='血清总胆红素测定')  and hisid in(select hisid from 住院明细 where item_name ='血清间接胆红素测定' ))  and a.BILLING_TIME>'2023-10-01'  order by 住院门诊号,费用发生时间  "
  },
  {
    "name": "2",
    "filename_prefix": "同时收心电监测和血氧饱和度监测",
    "codes": [
      ""
    ],
    "sql_template": "select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称,case when item_name in('无创血压监测','脉搏监测','血氧饱和度监测','呼吸监测','体温监测') then '1' else '0' end 违规标记  from  门诊明细 a left join 门诊主单 b on a.hisid=b.hisid   where  item_name in ('心电监测','无创血压监测','脉搏监测','血氧饱和度监测','呼吸监测','体温监测') and a.hisid in(select hisid from 门诊明细 where (item_name='心电监测') and hisid in(select hisid from 门诊明细 where item_name in('无创血压监测','脉搏监测','血氧饱和度监测','呼吸监测','体温监测')))  and b.BILL_DATE>'2023-10-01' union all select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称,case when item_name in('无创血压监测','脉搏监测','血氧饱和度监测','呼吸监测','体温监测')  then '1' else '0' end 违规标记  from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where item_name in ('心电监测','无创血压监测','脉搏监测','血氧饱和度监测','呼吸监测','体温监测')  and a.hisid in(select hisid from 住院明细 where (item_name='心电监测')  and hisid in(select hisid from 住院明细 where item_name in('无创血压监测','脉搏监测','血氧饱和度监测','呼吸监测','体温监测') ))  and a.BILLING_TIME>'2023-10-01' order by 住院门诊号,费用发生时间 "
  },
  {
    "name": "3",
    "filename_prefix": "收取特殊疾病护理后还收取了级别护理",
    "codes": [
      ""
    ],
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称,case when item_name like '%特殊疾病护理%'  then '1' else '0' end 违规标记 from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where  (item_name  like '%级护理%' or item_name  ='特殊疾病护理' ) and a.hisid in(select hisid from 住院明细 where   item_name  ='特殊疾病护理'   and hisid in(select hisid from 住院明细 where item_name like '%级护理%')) and    a.BILLING_TIME>'2023-10-01'  order by a.hisid,BILLING_TIME "
  },
  {
    "name": "4",
    "filename_prefix": "收取特级护理不得再收取口腔护理、压疮预防和护理、管路护理等专项护理费用",
    "codes": [
      ""
    ],
    "sql_template": " select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称,case when item_name in ('口腔护理','一般专项护理','吸痰护理','动静脉置管护理','引流管护理','造瘘护理','一般专项护理(口腔护理)','气管切开护理') then '1' else '0' end 违规标记 from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where  item_name  in('特级护理','口腔护理','一般专项护理','吸痰护理','动静脉置管护理','引流管护理','造瘘护理','一般专项护理(口腔护理)','气管切开护理') and a.hisid in(select hisid from 住院明细 where  item_name  in('特级护理')  and  hisid in(select hisid from 住院明细 where item_name in('口腔护理','一般专项护理','吸痰护理','动静脉置管护理','引流管护理','造瘘护理','一般专项护理(口腔护理)','气管切开护理') ))  and a.BILLING_TIME>'2023-10-01' order by a.hisid,BILLING_TIME ",
    "sql": "的"
  },
  {
    "name": "5",
    "filename_prefix": "换药后不能收取拆线",
    "codes": [
      ""
    ],
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称,case when item_name in ('角膜拆线') then '1' else '0' end 违规标记  from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where  item_name in('小换药','中换药','大换药','特大换药','角膜拆线') and a.hisid in(select hisid from 住院明细 where  item_name  in('小换药','中换药','大换药','特大换药') and hisid in(select hisid from 住院明细 where item_name in('角膜拆线') ))  and a.BILLING_TIME>'2023-10-01' union all select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称,case when item_name in('角膜拆线') then '1' else '0' end 违规标记  from 门诊明细 a left join 门诊主单 b on a.hisid=b.hisid  where item_name in('小换药','中换药','大换药','特大换药','角膜拆线') and a.hisid in(select hisid from 门诊明细 where  item_name  in('小换药','中换药','大换药','特大换药') and hisid in(select hisid from 门诊明细 where item_name in('角膜拆线') )) and b.BILL_DATE>'2023-10-01'  order by 住院门诊号,费用发生时间 "
  },
  {
    "name": "6",
    "filename_prefix": "眼科手术中已含显微镜下，不应再另外收取",
    "codes": [
      "004300000130000-430000013",
      "004300000050000-430000005",
      "004300000090000-430000009",
      "004300000170000-430000017",
      "004300000100000-430000010"
    ],
    "sql_template": " select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称,case when item_name like '%显微镜%' then '1' else '0' end 违规标记  from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where (item_name in('翼状胬肉切除术','球结膜瓣复盖术','白内障囊外摘除','白内障囊外摘除+人工晶体植入术') or  item_name like '%显微镜%' ) and a.hisid in(select hisid from 住院明细 where  item_name  in('翼状胬肉切除术','球结膜瓣复盖术','白内障囊外摘除','白内障囊外摘除+人工晶体植入术') and hisid in(select hisid from 住院明细 where item_name like '%显微镜%' ))   and a.BILLING_TIME>'2023-10-01' union all select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称,case when item_name like '%显微镜%' then '1' else '0' end 违规标记 from 门诊明细 a left join 门诊主单 b on a.hisid=b.hisid  where (item_name in('翼状胬肉切除术','球结膜瓣复盖术','白内障囊外摘除','白内障囊外摘除+人工晶体植入术') or  item_name like '%显微镜%' ) and a.hisid in(select hisid from 门诊明细 where  item_name  in('翼状胬肉切除术','球结膜瓣复盖术','白内障囊外摘除','白内障囊外摘除+人工晶体植入术') and hisid in(select hisid from 门诊明细 where item_name like '%显微镜%' )) and b.BILL_DATE>'2023-10-01'  order by 住院门诊号,费用发生时间 "
  },
  {
    "name": "7",
    "filename_prefix": "三磷酸腺苷二钠注射液、注射用辅酶A限急救 抢救患者。",
    "codes": [
      ""
    ],
    "sql_template": " select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称  from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where  item_name in('三磷酸腺苷二钠注射液','注射用辅酶A')    and a.BILLING_TIME>'2023-10-01' union all select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称 from  门诊明细 a left join 门诊主单 b on a.hisid=b.hisid   where  item_name in('三磷酸腺苷二钠注射液','注射用辅酶A') and b.BILL_DATE>'2023-10-01'  order by 住院门诊号,费用发生时间 "
  },
  {
    "name": "8",
    "filename_prefix": "人血白蛋白限抢救、重症或因肝硬化、癌症引起胸腹水的患者",
    "codes": [
      ""
    ],
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称  from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where  item_name in('人血白蛋白')  and a.BILLING_TIME>'2023-10-01' union all select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称  from  门诊明细 a left join 门诊主单 b on a.hisid=b.hisid   where  item_name in('人血白蛋白') order by 住院门诊号,费用发生时间 "
  },
  {
    "name": "9",
    "filename_prefix": "注射用泮托拉唑钠、注射用奥美拉唑钠限有禁食医嘱或吞咽困难的患者",
    "codes": [
      ""
    ],
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称 from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where  item_name in('注射用泮托拉唑钠','注射用奥美拉唑钠')  and a.BILLING_TIME>'2023-10-01' union all select  '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称  from  门诊明细 a left join 门诊主单 b on a.hisid=b.hisid   where  item_name in('注射用泮托拉唑钠','注射用奥美拉唑钠')  and b.BILL_DATE>'2023-10-01'  order by 住院门诊号,费用发生时间"
  },
  {
    "name": "10",
    "filename_prefix": "美罗培南限重症感染的治疗",
    "codes": [
      ""
    ],
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,a.zyh 住院门诊号,b.PATIENT_ID  就诊id,a.BILLING_TIME 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称 from 住院明细 a left join 住院主单 b on a.zyh=b.zyh where   item_name in('注射用美罗培南')   and a.BILLING_TIME>'2023-10-01' union all select '门诊'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别, TIMESTAMPDIFF(YEAR, PATIENT_BIRTHDAY, CURDATE())  年龄,','参保所属医保区划,b.PATIENT_ID 证件号码,b.BILL_DATE 开始日期,b.BILL_DATE 结束日期,b.BILL_DATE 结算时间,1 住院天数,MZH 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,P_TYPE 收费项目等级,ITEM_ID 医保目录编码,ITEM_NAME 医保目录名称,BENEFIT_TYPE 险种类型,BENEFIT_GROUP_ID 人员类别,',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, num 数量,UNIT_PRICE 单价,COST 明细项目费用总额,ITEM_ID_HOSP 医院项目编码, ITEM_NAME_HOSP 医院项目名称,P_CATEGORY 医疗收费项目类别,a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,EXCUTE_DEPT_NAME `受单科室名称`,a.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,ADMISSION_DISEASE_NAME 诊断名称 from  门诊明细 a left join 门诊主单 b on a.hisid=b.hisid   where  item_name in('注射用美罗培南') and b.BILL_DATE>'2023-10-01'   order by 住院门诊号,费用发生时间 "
  },
  {
    "name": "11",
    "filename_prefix": "级别护理天数超出住院天数",
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.admission_date 开始日期,b.discharge_date 结束日期,b.BILL_DATE 结算时间,  zyh 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,'' 收费项目等级,  ',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,'' `受单科室名称`,b.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称, 护理收费天数,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,护理收费天数-CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 多收天数 from (select HISID,sum(num) 护理收费天数  from 住院明细 where  item_name in('Ⅰ级护理','Ⅱ级护理','Ⅲ级护理') group by HISID )a left join   住院主单  b on a.hisid=b.hisid where a.护理收费天数 >CEILING(DATEDIFF( discharge_date,admission_date) / 1.0)   and b.BILL_DATE>'2023-10-01'",
    "codes": []
  },
  {
    "name": "12",
    "filename_prefix": "床位费超出住院天数",
    "sql_template": "select '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.admission_date 开始日期,b.discharge_date 结束日期,b.BILL_DATE 结算时间,  zyh 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,'' 收费项目等级,  ',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,'' `受单科室名称`,b.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称, 床位收费天数,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,床位收费天数-CEILING(DATEDIFF( discharge_date,admission_date) / 1.0)  多收天数  from (select HISID,sum(num) 床位收费天数  from 住院明细 where  item_name like '%普通病房床位费%' group by HISID )a left join      住院主单  b on a.hisid=b.hisid where a.床位收费天数 >CEILING(DATEDIFF( discharge_date,admission_date) / 1.0)  and b.BILL_DATE>'2023-10-01'",
    "codes": []
  },
  {
    "name": "13",
    "filename_prefix": "诊查费超出住院天数",
    "sql_template": "select  '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.admission_date 开始日期,b.discharge_date 结束日期,b.BILL_DATE 结算时间,  zyh 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,'' 收费项目等级,  ',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,'' `受单科室名称`,b.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称, 诊查收费天数,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,诊查收费天数-CEILING(DATEDIFF( discharge_date,admission_date) / 1.0)  多收天数 from (select HISID,sum(num) 诊查收费天数  from 住院明细 where  item_name ='住院诊查费' group by HISID )a left join 住院主单  b on a.hisid=b.hisid where a.诊查收费天数 >CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) and b.BILL_DATE>'2023-10-01'",
    "codes": [],
    "sql": "select  '住院'类别,PATIENT_NAME 人员姓名,PATIENT_GENDER 性别,PATIENT_AGE 年龄,','参保所属医保区划,b.ID_CARD 证件号码,b.admission_date 开始日期,b.discharge_date 结束日期,b.BILL_DATE 结算时间,  zyh 住院门诊号,b.PATIENT_ID  就诊id,b.BILL_DATE 费用发生时间,a.hisid 结算id,b.HOSPITAL_ID 定点医药机构编号,b.HOSPITAL_NAME 定点医药机构名称,SOCIAL_ID 人员编号,SOCIAL_ID 人员参保关系id,'' 收费项目等级,  ',' 医疗类别,',' 清算方式,',' 个人结算方式,TOTAL_AMOUNT 医疗费总额,0 先行自付金额,b.BMI_CONVERED_AMOUNT 符合范围金额,0 起付标准,0 本次起付线,0 实际支付起付线,BMI_PAY_AMOUNT 统筹基金支出,0 基本医疗统筹支付比例,0 医保认可费用总额,0 公务员医疗补助资金支出,0 补充医疗保险基金支出,0 大病补充医疗保险基金支出,0 大额医疗补助基金支出,0 伤残人员医疗保障基金支出,0 医疗救助基金支出,0 其它基金支付,0 基金支付总额,SELF_PAY_AMOUNT+CASH 个人支付金额,SELF_PAY_AMOUNT 个人账户支出,CASH 现金支付金额,0 自费中医院负担部分,0 余额,0 账户共济支付金额,b.REFUND_FLAG_TYPE 退费结算标志,',' 计算住院次数标志,',' 结算现金支付方式,year(b.BILL_DATE)年度, a.hisid 数据唯一记录号,DISCHARGE_DEPT_NAME 开单科室名称,'' `受单科室名称`,b.DOCTOR_NAME 开单医师姓名,b.DOCTOR_NAME `受单医师姓名`,诊断 诊断名称, 诊查收费天数,CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) 住院天数,诊查收费天数-CEILING(DATEDIFF( discharge_date,admission_date) / 1.0)  多收天数 from (select HISID,sum(num) 诊查收费天数  from 住院明细 where  item_name ='住院诊查费' group by HISID )a left join 住院主单  b on a.hisid=b.hisid where a.诊查收费天数 >CEILING(DATEDIFF( discharge_date,admission_date) / 1.0) and b.BILL_DATE>'2023-10-01'"
  },
  {
    "name": "14",
    "filename_prefix": "厕所",
    "codes": [],
    "sql_template": "select *from temp"
  }
]